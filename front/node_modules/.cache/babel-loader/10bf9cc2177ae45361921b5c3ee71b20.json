{"ast":null,"code":"export default {\n  name: \"P_UserCenter\",\n\n  data() {\n    return {\n      isLogin: true,\n      uname: \"\",\n      rank: 1,\n      isChangeUName: false\n    };\n  },\n\n  computed: {\n    headerIconSrc() {\n      if (this.rank === 1) {\n        return \"/static/img/normalUser.png\";\n      } else {\n        return \"/static/img/superUser.png\";\n      }\n    },\n\n    headerFont() {\n      if (this.rank === 1) {\n        return \"headerNormalFont\";\n      } else {\n        return \"headerSuperFont\";\n      }\n    }\n\n  },\n\n  mounted() {\n    this.getUserCenterInfo();\n  },\n\n  methods: {\n    getCookie(objName) {\n      //获取指定名称的cookie的值\n      const arrStr = document.cookie.split(\"; \");\n\n      for (let i = 0; i < arrStr.length; i++) {\n        const temp = arrStr[i].split(\"=\");\n        if (temp[0] === objName) return temp[1];\n      }\n\n      return null;\n    },\n\n    getToken() {\n      return this.getCookie(\"NBI_token\");\n    },\n\n    getUID() {\n      return this.getCookie(\"NBI_UID\");\n    },\n\n    uploadNewUName() {\n      this.isChangeUName = false;\n      let changeUnameForm = new FormData();\n      changeUnameForm.append(\"token\", this.getToken());\n      changeUnameForm.append(\"uid\", this.getUID());\n      changeUnameForm.append(\"name\", this.uname);\n      this.$axios.post(\"/NBI/User/uploadNewUName\", changeUnameForm, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(response => {\n        if (response.data === 1) {\n          this.$message({\n            showClose: true,\n            message: '您的账号状态错误！',\n            type: 'error'\n          });\n        } else {\n          this.$message({\n            showClose: true,\n            message: '修改用户名成功！',\n            type: 'success'\n          });\n        }\n      });\n    },\n\n    getUserCenterInfo() {\n      let getUserInfoForm = new FormData();\n      getUserInfoForm.append(\"token\", this.getToken());\n      getUserInfoForm.append(\"uid\", this.getUID());\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      };\n      this.$axios.post(\"/NBI/User/getUserInfo/\", getUserInfoForm, config).then(response => {\n        console.log(response);\n\n        if (response.data === 1) {\n          this.isLogin = false;\n          this.$message({\n            showClose: true,\n            message: '没有找到您的用户信息，您可能是没有登录或通信不畅',\n            type: 'error'\n          });\n        } else {\n          this.isLogin = true;\n          this.uname = response.data.name;\n          this.rank = response.data.rank;\n        }\n      });\n    },\n\n    userLogOut() {\n      // 注销\n      let logoutForm = new FormData();\n      logoutForm.append(\"token\", this.getToken());\n      logoutForm.append(\"uid\", this.getUID());\n      this.$axios.post(\"/NBI/User/logout\", logoutForm, {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(response => {\n        console.log(response);\n\n        if (response.data === 1) {\n          this.$message({\n            showClose: true,\n            message: '注销失败，您的账号状态错误！',\n            type: 'error'\n          });\n        } else if (response.data === 2) {\n          this.$message({\n            showClose: true,\n            message: '您已注销',\n            type: 'warning'\n          });\n          this.isLogin = false;\n          this.$bus.$emit('changeStatus', {\n            status: false,\n            uname: \"\"\n          });\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AAqCA;EACAA,oBADA;;EAEAC;IACA;MACAC,aADA;MAEAC,SAFA;MAGAC,OAHA;MAIAC;IAJA;EAMA,CATA;;EAUAC;IACAC;MACA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA,CARA;;IASAC;MACA;QACA;MACA,CAFA,MAGA;QACA;MACA;IACA;;EAhBA,CAVA;;EA4BAC;IACA;EACA,CA9BA;;EA+BAC;IACAC;MAAA;MACA;;MACA;QACA;QACA;MACA;;MACA;IACA,CARA;;IASAC;MACA;IACA,CAXA;;IAYAC;MACA;IACA,CAdA;;IAeAC;MACA;MACA;MACAC;MACAA;MACAA;MACA;QACAC;UAAA;QAAA;MADA,GAEAC,IAFA,CAEAC;QACA;UACA;YACAC,eADA;YAEAC,oBAFA;YAGAC;UAHA;QAKA,CANA,MAMA;UACA;YACAF,eADA;YAEAC,mBAFA;YAGAC;UAHA;QAKA;MACA,CAhBA;IAiBA,CAtCA;;IAuCAC;MACA;MACAC;MACAA;MACA;QACAP;UAAA;QAAA;MADA;MAGA;QACAQ;;QACA;UACA;UACA;YACAL,eADA;YAEAC,mCAFA;YAGAC;UAHA;QAKA,CAPA,MAOA;UACA;UACA;UACA;QACA;MACA,CAdA;IAeA,CA7DA;;IA8DAI;MACA;MACA;MACAC;MACAA;MACA;QACAV;UAAA;QAAA;MADA,GAEAC,IAFA,CAEAC;QACAM;;QACA;UACA;YACAL,eADA;YAEAC,yBAFA;YAGAC;UAHA;QAKA,CANA,MAOA;UACA;YACAF,eADA;YAEAC,eAFA;YAGAC;UAHA;UAKA;UACA;YAAAM;YAAAxB;UAAA;QACA;MACA,CApBA;IAqBA;;EAxFA;AA/BA","names":["name","data","isLogin","uname","rank","isChangeUName","computed","headerIconSrc","headerFont","mounted","methods","getCookie","getToken","getUID","uploadNewUName","changeUnameForm","headers","then","response","showClose","message","type","getUserCenterInfo","getUserInfoForm","console","userLogOut","logoutForm","status"],"sourceRoot":"src/components/userCenterPage","sources":["UserCenter.vue"],"sourcesContent":["<template>\n  <div id=\"userCenterPageContainer\">\n    <div v-show=\"isLogin\" id=\"userCenterInner\">\n      <div id=\"userCenterHeader\">\n        <div style=\"width: 15%;height: 70%;display: flex;justify-content: center;align-items: center;\">\n          <img :src=\"headerIconSrc\" id=\"userCenterHeader_icon\" alt=\"加载失败\">\n        </div>\n        <div style=\"width: 25%;height: 70%;display: flex;flex-direction: column;justify-content: center;align-items: start\">\n          <div style=\"width: 100%;height: 60%; display: flex;justify-content: start;align-items: center;\">\n            <p v-show=\"!isChangeUName\" id=\"headerNameFont\">{{uname}}</p>\n            <input type=\"text\" v-model=\"uname\" v-show=\"isChangeUName\" @keyup.enter=\"uploadNewUName()\" style=\"height: 68%;width: 90%;border-radius: 4px;border: 1px #0b007e solid;\"/>\n            <div id=\"changeUnameBtn\" @click=\"isChangeUName = true\" class=\"el-icon-edit\"></div>\n          </div>\n          <div style=\"width: 100%;height: 35%; display: flex;justify-content: start;align-items: center;\" :class=\"headerFont\">\n            <p>您是：{{rank===1?'普通':'超级'}}用户</p>\n            <el-popover\n              placement=\"top-start\"\n              width=\"100\"\n              title=\"用户等级\"\n              trigger=\"hover\"\n              content=\"超级用户每天可以无限次生成/保存图片，且享有快速处理通道。\">\n              <el-button style=\"cursor: help;margin-left: 20px;margin-right: 10px;\" size=\"small\" slot=\"reference\" icon=\"el-icon-link\" circle></el-button>\n            </el-popover>\n          </div>\n        </div>\n        <div style=\"width: 60%;height: 70%;display: flex;flex-direction: row;justify-content: end; align-items: center\">\n          <div @click=\"userLogOut()\" id=\"logOutBtn\"><p>Log Out</p></div>\n        </div>\n      </div>\n    </div>\n    <div v-show=\"!isLogin\" id=\"noInfoShow\">\n      <img src=\"/static/img/userCenterBG.png\" style=\"width: 28%\">\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"P_UserCenter\",\n  data(){\n    return {\n      isLogin: true,\n      uname: \"\",\n      rank: 1,\n      isChangeUName: false,\n    }\n  },\n  computed:{\n    headerIconSrc(){\n      if (this.rank === 1){\n        return \"/static/img/normalUser.png\";\n      }\n      else{\n        return \"/static/img/superUser.png\";\n      }\n    },\n    headerFont(){\n      if (this.rank === 1){\n        return \"headerNormalFont\";\n      }\n      else{\n        return \"headerSuperFont\";\n      }\n    }\n  },\n  mounted() {\n    this.getUserCenterInfo();\n  },\n  methods:{\n    getCookie(objName){//获取指定名称的cookie的值\n      const arrStr = document.cookie.split(\"; \");\n      for(let i = 0; i < arrStr.length; i ++){\n        const temp = arrStr[i].split(\"=\");\n        if(temp[0] === objName) return temp[1];\n      }\n      return null;\n    },\n    getToken(){\n      return this.getCookie(\"NBI_token\");\n    },\n    getUID(){\n      return this.getCookie(\"NBI_UID\");\n    },\n    uploadNewUName(){\n      this.isChangeUName = false;\n      let changeUnameForm = new FormData();\n      changeUnameForm.append(\"token\", this.getToken());\n      changeUnameForm.append(\"uid\", this.getUID());\n      changeUnameForm.append(\"name\",this.uname);\n      this.$axios.post(\"/NBI/User/uploadNewUName\",changeUnameForm, {\n         headers: {'Content-Type': 'multipart/form-data'}\n      }).then((response)=>{\n        if (response.data===1){\n          this.$message({\n            showClose: true,\n            message: '您的账号状态错误！',\n            type: 'error',\n          });\n        }else{\n          this.$message({\n            showClose: true,\n            message: '修改用户名成功！',\n            type: 'success',\n          });\n        }\n      });\n    },\n    getUserCenterInfo(){\n      let getUserInfoForm = new FormData();\n      getUserInfoForm.append(\"token\", this.getToken());\n      getUserInfoForm.append(\"uid\", this.getUID());\n      let config = {\n         headers: {'Content-Type': 'multipart/form-data'}\n      };\n      this.$axios.post(\"/NBI/User/getUserInfo/\",getUserInfoForm, config).then((response)=>{\n        console.log(response)\n        if (response.data===1){\n          this.isLogin = false;\n          this.$message({\n            showClose: true,\n            message: '没有找到您的用户信息，您可能是没有登录或通信不畅',\n            type: 'error'\n          });\n        }else{\n          this.isLogin = true;\n          this.uname = response.data.name;\n          this.rank = response.data.rank;\n        }\n      });\n    },\n    userLogOut(){\n      // 注销\n      let logoutForm = new FormData();\n      logoutForm.append(\"token\", this.getToken());\n      logoutForm.append(\"uid\", this.getUID());\n      this.$axios.post(\"/NBI/User/logout\",logoutForm, {\n         headers: {'Content-Type': 'multipart/form-data'}\n      }).then((response)=>{\n        console.log(response)\n        if (response.data === 1){\n          this.$message({\n            showClose: true,\n            message: '注销失败，您的账号状态错误！',\n            type: 'error'\n          });\n        }\n        else if (response.data === 2){\n          this.$message({\n            showClose: true,\n            message: '您已注销',\n            type: 'warning',\n          });\n          this.isLogin = false;\n          this.$bus.$emit('changeStatus', {status: false, uname: \"\"});\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style scoped>\n#userCenterPageContainer{\n  width: 100%;\n  height: 100%;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n#userCenterInner{\n  width: 75%;\n  height: 90%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n}\n#noInfoShow{\n  width: 75%;\n  height: 90%;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n}\n#userCenterHeader{\n  height: 20%;\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  border-bottom: 1px solid #07004f;\n}\n#userCenterHeader_icon{\n  height: 80%;\n  border-radius: 5px;\n  border: 1px #07004f solid;\n}\n.headerSuperFont{\n  color: goldenrod;\n  font-family: 幼圆,serif;\n}\n.headerNormalFont{\n  color: gray;\n  font-family: 幼圆,serif;\n}\n#headerNameFont{\n  color: #07004f;\n  font-family: \"Droid Sans Mono\", \"DejaVu Sans Mono\", monospace;\n  font-weight: bolder;\n  font-size: x-large;\n  cursor: pointer;\n  transition: 0.3s ease;\n}\n#headerNameFont:hover{\n  color: #0b007e;\n}\n#logOutBtn{\n  width: 28%;\n  height: 40%;\n  border: 1px solid red;\n  color: #0b007e;\n  font-family: \"Droid Sans Mono\", \"DejaVu Sans Mono\", monospace;\n  margin-right: 5%;\n  transition: 0.3s ease;\n  border-radius: 5px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  font-size: small;\n}\n#logOutBtn:hover{\n  cursor: pointer;\n  background-color: red;\n  color: white;\n}\n#changeUnameBtn{\n  margin-left: 10px;\n  cursor:pointer;\n  width: 20px;\n  height: 20px;\n  transition: 0.3s ease;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n#changeUnameBtn:hover{\n  background-color: gray;\n}\n</style>"]},"metadata":{},"sourceType":"module"}