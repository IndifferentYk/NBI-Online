{"ast":null,"code":"export default {\n  name: \"C_Header\",\n\n  data() {\n    return {\n      user: {\n        name: \"\",\n        status: false // true表示登录\n\n      },\n      selectedBtnClass: \"headerButton_selected\"\n    };\n  },\n\n  props: ['switchFunctionPage', 'functionPage'],\n  computed: {\n    userStatusColor() {\n      if (this.user.status) {\n        return {\n          color: \"forestgreen\"\n        };\n      } else {\n        return {\n          color: \"red\"\n        };\n      }\n    }\n\n  },\n\n  mounted() {\n    // 检查账户状态\n    this.accountStatusCheck();\n    this.$bus.$on('changeStatus', data => {\n      this.user.status = data.status;\n      this.user.name = data.uname;\n    });\n  },\n\n  beforeDestroy() {\n    this.$bus.$off('changeStatus');\n  },\n\n  methods: {\n    // cookie\n    getCookie(objname) {\n      //获取指定名称的cookie的值\n      const arrstr = document.cookie.split(\"; \");\n\n      for (let i = 0; i < arrstr.length; i++) {\n        const temp = arrstr[i].split(\"=\");\n        if (temp[0] === objname) return temp[1];\n      }\n\n      return null;\n    },\n\n    setCookie(name, value, hours, path) {\n      const expires = new Date();\n      expires.setTime(expires.getTime() + hours * 3600000);\n      path = path === \"\" ? \"\" : \";path=\" + path;\n\n      const _expires = typeof hours == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\n\n      document.cookie = name + \"=\" + value + _expires + path;\n    },\n\n    clearCookie(name) {\n      this.setCookie(name, \"\", -1, \"/NBI\");\n    },\n\n    getToken() {\n      return this.getCookie(\"NBI_token\");\n    },\n\n    getUID() {\n      return this.getCookie(\"NBI_UID\");\n    },\n\n    accountStatusCheck() {\n      // 本地无token，未登录\n      const token = this.getToken();\n\n      if (token === null) {\n        this.user.status = false;\n        return;\n      } // 本地有token，与uid一起上传\n\n\n      const uid = this.getUID();\n      this.$axios.post('/NBI/User/checkByToken/', {\n        \"uid\": uid,\n        \"token\": token\n      }).then(response => {\n        const checkResult = response.data.check;\n        const newToken = response.data.token;\n        const uname = response.data.uname;\n\n        if (checkResult === 0) {\n          this.user.status = false;\n        } else if (checkResult === 1) {\n          this.user.status = false;\n          alert(\"登录已过期，请重新登录\");\n          this.clearCookie(\"NBI_token\");\n        } else if (checkResult === 2) {\n          this.setCookie(\"NBI_token\", newToken, 2, \"/NBI\");\n          this.user.name = uname;\n          this.user.status = true;\n        }\n      });\n    }\n\n  }\n};","map":{"version":3,"mappings":"AA0CA;EACAA,gBADA;;EAEAC;IACA;MACAC;QACAF,QADA;QAEAG,aAFA,CAEA;;MAFA,CADA;MAKAC;IALA;EAOA,CAVA;;EAWAC,6CAXA;EAYAC;IACAC;MACA;QACA;UAAAC;QAAA;MACA,CAFA,MAGA;QACA;UAAAA;QAAA;MACA;IACA;;EARA,CAZA;;EAsBAC;IACA;IACA;IACA;MACA;MACA;IACA,CAHA;EAIA,CA7BA;;EA8BAC;IACA;EACA,CAhCA;;EAiCAC;IACA;IACAC;MAAA;MACA;;MACA;QACA;QACA;MACA;;MACA;IACA,CATA;;IAUAC;MACA;MACAC;MACAC;;MACA;;MACAC;IACA,CAhBA;;IAiBAC;MACA;IACA,CAnBA;;IAoBAC;MACA;IACA,CAtBA;;IAuBAC;MACA;IACA,CAzBA;;IA0BAC;MACA;MACA;;MACA;QACA;QACA;MACA,CANA,CAQA;;;MACA;MACA;QACA,UADA;QAEA;MAFA,GAGAC,IAHA,CAGAC;QACA;QACA;QACA;;QACA;UACA;QACA,CAFA,MAGA;UACA;UACAC;UACA;QACA,CAJA,MAKA;UACA;UACA;UACA;QACA;MACA,CApBA;IAqBA;;EAzDA;AAjCA","names":["name","data","user","status","selectedBtnClass","props","computed","userStatusColor","color","mounted","beforeDestroy","methods","getCookie","setCookie","expires","path","document","clearCookie","getToken","getUID","accountStatusCheck","then","response","alert"],"sourceRoot":"src/components","sources":["Header.vue"],"sourcesContent":["<template>\n    <div id=\"mainPageHeader\">\n        <div id=\"iconContainer\">\n            <img src=\"@/assets/webicon.jpg\" alt=\"图片加载失败\" style=\"height: 80%; align-self: center; border-radius: 8%\">\n        </div>\n        <div id=\"nameContainer\">\n            <div style=\"width: 100%; text-align: left; height: 45%; display: inline-flex;\">\n                <p class=\"headerFont\">\n                        NBI\n                </p>\n                <p style=\"color: #eaeaea;font-size: 120%;font-style: normal;line-height: 90%;vertical-align: center;font-weight: bolder;margin-left: 30px\">\n                        Image\n                    </p>\n                <p style=\"color: #eaeaea;font-size: 120%;font-style: normal;line-height: 90%;vertical-align: center;font-weight: bolder;margin-left: 30px\">\n                        Transformer\n                    </p>\n            </div>\n            <div style=\"width: 100%; text-align: left; height: 25%; display: inline-flex;cursor: pointer\" onclick=\"jumpToIDMG()\">\n                <p style=\"font-size: 86%;margin-top: 4%;font-style: normal;line-height: 90%;vertical-align: center;\">\n                        BUPT\n                </p>\n                <p style=\"font-size: 86%;margin-top: 4%;font-style: normal;line-height: 90%;vertical-align: center;margin-left: 5px\">\n                        -\n                </p>\n                <p style=\"font-size: 86%;margin-top: 4%;font-style: normal;line-height: 90%;vertical-align: center;margin-left: 5px\">\n                        IDMG\n                </p>\n            </div>\n        </div>\n        <div id=\"headerSwitchContainer\">\n            <div id=\"accountStatusContainer\" @click=\"switchFunctionPage(4)\">\n                <p v-show=\"user.status\" id=\"accountInfo\">{{user.name}}</p>\n                <p id=\"accountStatus\" :style=\"userStatusColor\">{{user.status === false? \"登录 / 注册\":\"欢迎您\"}}</p>\n            </div>\n            <div class=\"headerButton\" :class=\"functionPage===1? selectedBtnClass:''\"  @click=\"switchFunctionPage(1)\"><p>图片处理</p></div>\n            <div class=\"headerButton\" :class=\"functionPage===2? selectedBtnClass:''\"  @click=\"switchFunctionPage(2)\"><p>用户中心</p></div>\n            <div class=\"headerButton\" :class=\"functionPage===3? selectedBtnClass:''\"  @click=\"switchFunctionPage(3)\"><p>历史数据</p></div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n  name: \"C_Header\",\n  data(){\n    return {\n      user:{\n          name: \"\",\n          status: false, // true表示登录\n      },\n      selectedBtnClass: \"headerButton_selected\",\n    }\n  },\n  props:['switchFunctionPage', 'functionPage'],\n  computed:{\n    userStatusColor(){\n      if (this.user.status){\n        return {color: \"forestgreen\"};\n      }\n      else{\n        return {color: \"red\"};\n      }\n    }\n  },\n  mounted(){\n    // 检查账户状态\n    this.accountStatusCheck();\n    this.$bus.$on('changeStatus', (data)=>{\n      this.user.status = data.status;\n      this.user.name = data.uname;\n    });\n  },\n  beforeDestroy() {\n    this.$bus.$off('changeStatus');\n  },\n  methods:{\n    // cookie\n    getCookie(objname){//获取指定名称的cookie的值\n      const arrstr = document.cookie.split(\"; \");\n      for(let i = 0; i < arrstr.length; i ++){\n        const temp = arrstr[i].split(\"=\");\n        if(temp[0] === objname) return temp[1];\n      }\n      return null;\n    },\n    setCookie(name, value, hours, path) {\n      const expires = new Date();\n      expires.setTime(expires.getTime() + hours * 3600000);\n      path = path === \"\" ? \"\" : \";path=\" + path;\n      const _expires = (typeof hours) == \"string\" ? \"\" : \";expires=\" + expires.toUTCString();\n      document.cookie = name + \"=\" + value + _expires + path;\n    },\n    clearCookie(name) {\n      this.setCookie(name, \"\", -1, \"/NBI\");\n    },\n    getToken(){\n      return this.getCookie(\"NBI_token\");\n    },\n    getUID(){\n      return this.getCookie(\"NBI_UID\");\n    },\n    accountStatusCheck(){\n      // 本地无token，未登录\n      const token = this.getToken();\n      if (token === null){\n        this.user.status = false;\n        return;\n      }\n\n      // 本地有token，与uid一起上传\n      const uid = this.getUID();\n      this.$axios.post('/NBI/User/checkByToken/', {\n        \"uid\": uid,\n        \"token\": token,\n      }).then((response) => {\n        const checkResult = response.data.check;\n        const newToken = response.data.token;\n        const uname = response.data.uname;\n        if (checkResult === 0){\n          this.user.status = false;\n        }\n        else if(checkResult === 1){\n          this.user.status = false;\n          alert(\"登录已过期，请重新登录\");\n          this.clearCookie(\"NBI_token\");\n        }\n        else if(checkResult === 2){\n          this.setCookie(\"NBI_token\",newToken, 2, \"/NBI\");\n          this.user.name = uname;\n          this.user.status = true;\n        }\n      });\n    },\n  }\n}\n\n</script>\n\n<style scoped>\n#mainPageHeader{\n    width: 100%;\n    height: 90px;\n    /*background-image: linear-gradient(to right, rgb(220, 244, 255) , rgb(168, 227, 255));*/\n    background-color: #07004f;\n    background-repeat:no-repeat;\n    overflow: hidden;\n    float: right;\n    display: flex;\n    align-items: center;\n    z-index: 100;\n}\n.headerFont{\n  color: #eaeaea;\n  font-size: 110%;\n  line-height: 90%;\n  vertical-align: center;\n  font-weight: bolder;\n  font-family: 幼圆;\n}\n#iconContainer{\n    height: 70%;\n    width: 8%;\n    margin-left: 40px;\n    display: flex;\n    justify-content: center;\n    overflow: hidden;\n}\n\n#nameContainer{\n    height: 100%;\n    width: 25%;\n    margin-left: 3%;\n}\n\n#headerSwitchContainer{\n    height: 100%;\n    width: 60%;\n    /* margin-left: 6%; */\n    display: inline-flex;\n    justify-content: right;\n    overflow: hidden;\n}\n\n.headerButton{\n    cursor: pointer;\n    font-family: STHeiti;\n    height: 100%;\n    width: 20%;\n    margin-right: 2%;\n    transition: 0.3s ease;\n    background: rgba(255, 255, 255, 0);\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n\n.headerButton:hover{\n    background: rgba(255, 255, 255, 0.25);\n    color: #000042;\n}\n\n.headerButton_selected{\n    background: rgba(255, 255, 255, 0.28);\n    color: #000042;\n    border-bottom: white 2px solid;\n}\n\n#accountStatusContainer{\n    width: 40%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    transition: 0.2s ease;\n    flex-direction: column;\n    cursor: pointer;\n    overflow: hidden;\n}\n#accountStatus{\n    color: #2e2e2e;\n    font-family: Arial, Helvetica, sans-serif;\n    line-height: 20%;\n    margin-top: 5px;\n}\n#accountInfo{\n    color: #c91400;\n    font-family: Arial, Helvetica, sans-serif;\n    line-height: 20%;\n}\n</style>"]},"metadata":{},"sourceType":"module"}