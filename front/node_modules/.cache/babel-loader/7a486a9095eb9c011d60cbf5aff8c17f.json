{"ast":null,"code":"export default {\n  name: 'HistoryImageInfo',\n  props: ['GID'],\n\n  data() {\n    return {\n      infoForm: {\n        url: \"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\",\n        srcList: [\"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\", \"https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg\", 'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg'],\n        sampleName: '',\n        partName: '',\n        //部位 胃、大肠小肠、食管\n        preDiagnosis: [],\n        //术前诊断\n        pathologic: [],\n        //病理诊断\n        differentiation: [],\n        ///分化程度Integer分化程度多选：‘0’：不适用 ‘1‘：低分化 ‘2’：中分化 ‘3‘：高分化 多选\n        //infiltration: '',（单选，粘膜上皮层，粘膜固有层，粘膜肌层，粘膜下层（文本录入，单位μm），固有肌层）\n        cuttingEdge: true,\n        //水平切缘（单选，阴性，阳性\n        remark: '备注xxxx' //备注\n\n      },\n      preDiagnosisOptions: [{\n        value: '早癌',\n        label: '早癌'\n      }, {\n        value: '炎症',\n        label: '炎症'\n      }, {\n        value: '腺癌',\n        label: '腺癌'\n      }, {\n        value: '胃癌',\n        label: '胃癌'\n      }],\n      pathologicOptions: [{\n        value: '早癌',\n        label: '早癌'\n      }, {\n        value: '炎症',\n        label: '炎症'\n      }, {\n        value: '腺癌',\n        label: '腺癌'\n      }, {\n        value: '胃癌',\n        label: '胃癌'\n      }],\n      rules: {\n        sampleName: [{\n          required: true,\n          message: '请输入标本名称',\n          trigger: 'blur'\n        }, {\n          min: 2,\n          max: 20,\n          message: '长度在 2 到 20 个字符',\n          trigger: 'blur'\n        }],\n        partName: [{\n          required: true,\n          message: '请选择标本部位',\n          trigger: 'change'\n        }],\n        preDiagnosis: [{\n          type: 'array',\n          required: true,\n          message: '请至少选择一个活动性质',\n          trigger: 'change'\n        }],\n        pathologic: [{\n          type: 'array',\n          required: true,\n          message: '请至少选择一个诊断',\n          trigger: 'change'\n        }],\n        differentiation: [{\n          type: 'array',\n          required: true,\n          message: '请至少选择一个分化程度',\n          trigger: 'change'\n        }]\n      }\n    };\n  },\n\n  methods: {\n    submitForm(formName) {\n      let config = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      };\n      let tmp = this.infoForm.preDiagnosis;\n      let preDiagnosis = '';\n      tmp.forEach(elem => {\n        preDiagnosis = preDiagnosis + elem + '|';\n      });\n      tmp = this.infoForm.pathologic;\n      let pathologic = '';\n      tmp.forEach(elem => {\n        pathologic = pathologic + elem + '|';\n      });\n      console.log(pathologic, preDiagnosis);\n      let uploadForm = new FormData();\n      uploadForm.append(\"sampleName\", this.infoForm.sampleName);\n      uploadForm.append(\"partName\", this.infoForm.partName);\n      uploadForm.append(\"preDiagnosis\", preDiagnosis);\n      uploadForm.append(\"pathologic\", pathologic); //uploadForm.append(\"cuttingEdge\", this.infoForm.cuttingEdge)\n      // console.log(uploadForm)\n      // console.log(this.infoForm)\n\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          this.$axios.post('HistoryDetail', uploadForm, config).then(response => {\n            if (response.data === 2) {\n              this.$message({\n                message: '登录状态错误！请重新登录。',\n                type: 'error'\n              });\n            } else if (response.data === 1) {\n              this.$message({\n                message: '未找到对应图片信息',\n                type: 'warning'\n              });\n            } else {\n              alert('submit!');\n              console.log(response.data);\n            }\n          });\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    }\n\n  },\n\n  mounted() {\n    //console.log('this',this.GID)\n    this.$axios.get('HistoryDetail', {\n      params: {\n        GID: this.GID\n      }\n    }).then(response => {\n      if (response.data === 2) {\n        this.$message({\n          message: '登录状态错误！请重新登录。',\n          type: 'error'\n        });\n      } else if (response.data === 1) {\n        this.$message({\n          message: '未发现对应图片信息',\n          type: 'warning'\n        });\n      } else {\n        this.infoForm.sampleName = response.data.sampleName;\n        this.infoForm.partName = response.data.partName;\n        this.infoForm.preDiagnosis = response.data.preDiagnosis.split('|');\n        this.infoForm.pathologic = response.data.pathologic.split('|');\n        this.infoForm.cuttingEdge = response.data.cuttingEdge - '1';\n        this.infoForm.differentiation = response.data.differentiation.split('|');\n        this.infoForm.remark = response.data.remark;\n      }\n    });\n  }\n\n};","map":{"version":3,"mappings":"AAoEA;EACAA,wBADA;EAEAC,cAFA;;EAGAC;IACA;MACAC;QACAC,8EADA;QAEAC,UACA,yEADA,EAEA,yEAFA,EAGA,yEAHA,CAFA;QAOAC,cAPA;QAQAC,YARA;QAQA;QACAC,gBATA;QASA;QAEAC,cAXA;QAWA;QAEAC,mBAbA;QAaA;QACA;QACAC,iBAfA;QAeA;QACAC,gBAhBA,CAgBA;;MAhBA,CADA;MAmBAC;QACAC,WADA;QACAC;MADA,GAEA;QACAD,WADA;QACAC;MADA,CAFA,EAIA;QACAD,WADA;QACAC;MADA,CAJA,EAOA;QACAD,WADA;QACAC;MADA,CAPA,CAnBA;MA6BAC;QACAF,WADA;QACAC;MADA,GAEA;QACAD,WADA;QACAC;MADA,CAFA,EAIA;QACAD,WADA;QACAC;MADA,CAJA,EAMA;QACAD,WADA;QACAC;MADA,CANA,CA7BA;MAuCAE;QACAX,aACA;UAAAY;UAAAC;UAAAC;QAAA,CADA,EAEA;UAAAC;UAAAC;UAAAH;UAAAC;QAAA,CAFA,CADA;QAKAb,WACA;UAAAW;UAAAC;UAAAC;QAAA,CADA,CALA;QAQAZ,eACA;UAAAe;UAAAL;UAAAC;UAAAC;QAAA,CADA,CARA;QAWAX,aACA;UAAAc;UAAAL;UAAAC;UAAAC;QAAA,CADA,CAXA;QAcAV,kBACA;UAAAa;UAAAL;UAAAC;UAAAC;QAAA,CADA;MAdA;IAvCA;EA0DA,CA9DA;;EA+DAI;IACAC;MACA;QACAC;UAAA;QAAA;MADA;MAKA;MACA;MACAC;QACAnB;MACA,CAFA;MAGAmB;MACA;MACAA;QACAlB;MACA,CAFA;MAGAmB;MAEA;MACAC;MACAA;MACAA;MACAA,4CAtBA,CAuBA;MACA;MACA;;MAEA;QACA;UACA;YACA;cACA;gBACAV,wBADA;gBAEAI;cAFA;YAIA,CALA,MAMA;cACA;gBACAJ,oBADA;gBAEAI;cAFA;YAIA,CALA,MAMA;cACAO;cACAF;YACA;UACA,CAjBA;QAkBA,CAnBA,MAmBA;UACAA;UACA;QACA;MACA,CAxBA;IAyBA;;EArDA,CA/DA;;EAsHAG;IACA;IACA;MACAC;QACAC;MADA;IADA,GAIAC,IAJA,CAIAC;MACA;QACA;UACAhB,wBADA;UAEAI;QAFA;MAIA,CALA,MAMA;QACA;UACAJ,oBADA;UAEAI;QAFA;MAIA,CALA,MAMA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;MACA;IACA,CA1BA;EA2BA;;AAnJA","names":["name","props","data","infoForm","url","srcList","sampleName","partName","preDiagnosis","pathologic","differentiation","cuttingEdge","remark","preDiagnosisOptions","value","label","pathologicOptions","rules","required","message","trigger","min","max","type","methods","submitForm","headers","tmp","console","uploadForm","alert","mounted","params","GID","then","response"],"sourceRoot":"src/components/history/historyItemDetail","sources":["HistoryImageInfo.vue"],"sourcesContent":["<template>\r\n    <div id=\"imgPart\">\r\n        <div id=\"img_addInfoContainer\">\r\n            <el-form :model=\"infoForm\" :rules=\"rules\" ref=\"infoForm\" label-width=\"80px\" size=\"mini\">\r\n                <el-form-item label=\"上传图片\" prop=\"uploadImg\">\r\n                    <el-image style=\"width: 80px; height: 80px\" :src=\"infoForm.url\" :preview-src-list=\"infoForm.srcList\"\r\n                        :fit=\"contain\">\r\n                    </el-image>\r\n                </el-form-item>\r\n                <el-form-item label=\"标本名称\" prop=\"sampleName\">\r\n                    <el-input v-model=\"infoForm.sampleName\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"标本部位\" prop=\"partName\">\r\n                    <el-select v-model=\"infoForm.partName\" placeholder=\"请选择标本部位\">\r\n                        <el-option label=\"胃\" value=\"胃\"></el-option>\r\n                        <el-option label=\"大肠\" value=\"大肠\"></el-option>\r\n                        <el-option label=\"小肠\" value=\"小肠\"></el-option>\r\n                        <el-option label=\"食管\" value=\"食管\"></el-option>\r\n                        <el-option label=\"其它\" value=\"其它\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"术前诊断\" prop=\"preDiagnosis\">\r\n                    <el-select v-model=\"infoForm.preDiagnosis\" multiple filterable allow-create default-first-option\r\n                        placeholder=\"请选择术前诊断\">\r\n                        <el-option v-for=\"item in preDiagnosisOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                            :value=\"item.value\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"病理诊断\" prop=\"pathologic\">\r\n                    <el-select v-model=\"infoForm.pathologic\" multiple filterable allow-create default-first-option\r\n                        placeholder=\"请选择诊断\">\r\n                        <el-option v-for=\"item in pathologicOptions\" :key=\"item.value\" :label=\"item.label\"\r\n                            :value=\"item.value\">\r\n                        </el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n\r\n                <el-form-item label=\"分化程度\" prop=\"differentiation\">\r\n                    <el-checkbox-group v-model=\"infoForm.differentiation\">\r\n                        <el-checkbox label=\"0\" name=\"differentiation\"></el-checkbox>\r\n                        <el-checkbox label=\"1\" name=\"differentiation\"></el-checkbox>\r\n                        <el-checkbox label=\"2\" name=\"differentiation\"></el-checkbox>\r\n                        <el-checkbox label=\"3\" name=\"differentiation\"></el-checkbox>\r\n                        <el-checkbox label=\"4\" name=\"differentiation\"></el-checkbox>\r\n                    </el-checkbox-group>\r\n                </el-form-item>\r\n                <el-form-item label=\"水平切缘\" prop=\"cuttingEdge\">\r\n                    <el-switch v-model=\"infoForm.cuttingEdge\"></el-switch>\r\n                </el-form-item>\r\n                <el-form-item label=\"备注\" prop=\"remark\">\r\n                    <el-input type=\"textarea\" :autosize=\"{ minRows: 2, maxRows: 4 }\" placeholder=\"请输入备注\"\r\n                        v-model=\"infoForm.remark\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item>\r\n                    <el-button type=\"primary\" @click=\"submitForm('infoForm')\">立即创建</el-button>\r\n                    <!-- <el-button @click=\"resetForm('infoForm')\">重置</el-button> -->\r\n                </el-form-item>\r\n            </el-form>\r\n        </div>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n\r\nexport default {\r\n    name: 'HistoryImageInfo',\r\n    props: ['GID'],\r\n    data() {\r\n        return {\r\n            infoForm: {\r\n                url: \"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\",\r\n                srcList: [\r\n                    \"https://fuss10.elemecdn.com/e/5d/4a731a90594a4af544c0c25941171jpeg.jpeg\",\r\n                    \"https://fuss10.elemecdn.com/8/27/f01c15bb73e1ef3793e64e6b7bbccjpeg.jpeg\",\r\n                    'https://fuss10.elemecdn.com/3/28/bbf893f792f03a54408b3b7a7ebf0jpeg.jpeg',\r\n                ],\r\n                sampleName: '',\r\n                partName: '',//部位 胃、大肠小肠、食管\r\n                preDiagnosis: [],//术前诊断\r\n\r\n                pathologic: [],//病理诊断\r\n\r\n                differentiation: [],///分化程度Integer分化程度多选：‘0’：不适用 ‘1‘：低分化 ‘2’：中分化 ‘3‘：高分化 多选\r\n                //infiltration: '',（单选，粘膜上皮层，粘膜固有层，粘膜肌层，粘膜下层（文本录入，单位μm），固有肌层）\r\n                cuttingEdge: true,//水平切缘（单选，阴性，阳性\r\n                remark: '备注xxxx',//备注\r\n            },\r\n            preDiagnosisOptions: [{\r\n                value: '早癌', label: '早癌'\r\n            }, {\r\n                value: '炎症', label: '炎症'\r\n            }, {\r\n                value: '腺癌', label: '腺癌'\r\n            },\r\n            {\r\n                value: '胃癌', label: '胃癌'\r\n            }],\r\n            pathologicOptions: [{\r\n                value: '早癌', label: '早癌'\r\n            }, {\r\n                value: '炎症', label: '炎症'\r\n            }, {\r\n                value: '腺癌', label: '腺癌'\r\n            }, {\r\n                value: '胃癌', label: '胃癌'\r\n            }\r\n            ],\r\n            rules: {\r\n                sampleName: [\r\n                    { required: true, message: '请输入标本名称', trigger: 'blur' },\r\n                    { min: 2, max: 20, message: '长度在 2 到 20 个字符', trigger: 'blur' }\r\n                ],\r\n                partName: [\r\n                    { required: true, message: '请选择标本部位', trigger: 'change' }\r\n                ],\r\n                preDiagnosis: [\r\n                    { type: 'array', required: true, message: '请至少选择一个活动性质', trigger: 'change' }\r\n                ],\r\n                pathologic: [\r\n                    { type: 'array', required: true, message: '请至少选择一个诊断', trigger: 'change' }\r\n                ],\r\n                differentiation: [\r\n                    { type: 'array', required: true, message: '请至少选择一个分化程度', trigger: 'change' }\r\n                ],\r\n            }\r\n        };\r\n    },\r\n    methods: {\r\n        submitForm(formName) {\r\n            let config = {\r\n                headers: { 'Content-Type': 'multipart/form-data' }\r\n            };\r\n\r\n\r\n            let tmp = this.infoForm.preDiagnosis\r\n            let preDiagnosis = ''\r\n            tmp.forEach(elem => {\r\n                preDiagnosis = preDiagnosis + elem + '|'\r\n            })\r\n            tmp = this.infoForm.pathologic\r\n            let pathologic = ''\r\n            tmp.forEach(elem => {\r\n                pathologic = pathologic + elem + '|'\r\n            })\r\n            console.log(pathologic, preDiagnosis)\r\n\r\n            let uploadForm = new FormData();\r\n            uploadForm.append(\"sampleName\", this.infoForm.sampleName)\r\n            uploadForm.append(\"partName\", this.infoForm.partName)\r\n            uploadForm.append(\"preDiagnosis\", preDiagnosis)\r\n            uploadForm.append(\"pathologic\", pathologic)\r\n            //uploadForm.append(\"cuttingEdge\", this.infoForm.cuttingEdge)\r\n            // console.log(uploadForm)\r\n            // console.log(this.infoForm)\r\n\r\n            this.$refs[formName].validate((valid) => {\r\n                if (valid) {\r\n                    this.$axios.post('HistoryDetail', uploadForm, config).then((response) => {\r\n                        if (response.data === 2) {\r\n                            this.$message({\r\n                                message: '登录状态错误！请重新登录。',\r\n                                type: 'error'\r\n                            });\r\n                        }\r\n                        else if (response.data === 1) {\r\n                            this.$message({\r\n                                message: '未找到对应图片信息',\r\n                                type: 'warning'\r\n                            });\r\n                        }\r\n                        else {\r\n                            alert('submit!');\r\n                            console.log(response.data)\r\n                        }\r\n                    });\r\n                } else {\r\n                    console.log('error submit!!');\r\n                    return false;\r\n                }\r\n            });\r\n        }\r\n    },\r\n    mounted() {\r\n        //console.log('this',this.GID)\r\n        this.$axios.get('HistoryDetail', {\r\n            params: {\r\n                GID: this.GID\r\n            }\r\n        }).then((response) => {\r\n            if (response.data === 2) {\r\n                this.$message({\r\n                    message: '登录状态错误！请重新登录。',\r\n                    type: 'error'\r\n                });\r\n            }\r\n            else if (response.data === 1) {\r\n                this.$message({\r\n                    message: '未发现对应图片信息',\r\n                    type: 'warning'\r\n                });\r\n            }\r\n            else {\r\n                this.infoForm.sampleName = response.data.sampleName;\r\n                this.infoForm.partName = response.data.partName;\r\n                this.infoForm.preDiagnosis = response.data.preDiagnosis.split('|');\r\n                this.infoForm.pathologic = response.data.pathologic.split('|');\r\n                this.infoForm.cuttingEdge = response.data.cuttingEdge - '1';\r\n                this.infoForm.differentiation = response.data.differentiation.split('|');\r\n                this.infoForm.remark = response.data.remark;\r\n            }\r\n        })\r\n    },\r\n}\r\n</script>\r\n<style scoped>\r\n#img_addInfoContainer {\r\n    display: flex;\r\n    flex-direction: row;\r\n    margin-top: 5px;\r\n    width: 100%;\r\n    height: 638px;\r\n    justify-content: center;\r\n    align-items: center;\r\n}\r\n\r\n.el-tag+.el-tag {\r\n    margin-left: 10px;\r\n}\r\n\r\n.button-new-tag {\r\n    margin-left: 10px;\r\n    height: 32px;\r\n    line-height: 30px;\r\n    padding-top: 0;\r\n    padding-bottom: 0;\r\n}\r\n\r\n.input-new-tag {\r\n    width: 90px;\r\n    margin-left: 10px;\r\n    vertical-align: bottom;\r\n}\r\n\r\n/* #imgShowContainer {\r\n    display: flex;\r\n    flex-direction: row;\r\n    width: 100%;\r\n    height: 95px;\r\n    justify-content: center;\r\n    align-items: center;\r\n} */\r\n</style>"]},"metadata":{},"sourceType":"module"}